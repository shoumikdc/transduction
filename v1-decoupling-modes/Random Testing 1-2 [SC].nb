(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     50424,       1292]
NotebookOptionsPosition[     46589,       1222]
NotebookOutlinePosition[     46953,       1238]
CellTagsIndexPosition[     46910,       1235]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Generate random symplectic matrix mS", "Subsubsection",
 CellChangeTimes->{{3.7663137347727537`*^9, 
  3.7663137593274145`*^9}},ExpressionUUID->"14a1d5cd-b107-4f14-bc25-\
2eb3bfb8829a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"n", "=", "2"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"number", " ", "of", " ", "modes"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"randomSymMat", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a_", ",", "b_"}], "}"}], ",", "c_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"UpperTriangularize", "[", "#", "]"}], "+", 
        RowBox[{
         RowBox[{"UpperTriangularize", "[", 
          RowBox[{"#", ",", "1"}], "]"}], "\[Transpose]"}]}], ")"}], "&"}], 
     "@", 
     RowBox[{"RandomReal", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "b"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c", ",", "c"}], "}"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"random", " ", "c"}], "-", 
    RowBox[{"order", " ", "symmetric", " ", "matrix", " ", "valued", " ", 
     RowBox[{"in", " ", "[", 
      RowBox[{"a", ",", "b"}], "]"}]}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"mId", "[", "c_", "]"}], ":=", 
    RowBox[{"IdentityMatrix", "[", "c", "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"c", "-", 
    RowBox[{"order", " ", "idenitiy", " ", "matrix"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mJ", "=", 
    RowBox[{"ArrayFlatten", "[", 
     RowBox[{
      RowBox[{"(", GridBox[{
         {"0", "1"},
         {
          RowBox[{"-", "1"}], "0"}
        }], ")"}], "\[TensorProduct]", 
      RowBox[{"IdentityMatrix", "[", "n", "]"}]}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"symplectic", " ", "form", " ", "for", " ", "n", " ", "modes"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"randomSymplecticMat", "[", 
     RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"mId", "[", 
      RowBox[{"2", "n"}], "]"}], "-", 
     RowBox[{"Inverse", "[", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"mJ", ".", 
         RowBox[{"randomSymMat", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a", ",", "b"}], "}"}], ",", 
           RowBox[{"2", "n"}]}], "]"}]}], "+", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"mId", "[", 
          RowBox[{"2", "n"}], "]"}]}]}], ")"}], "]"}]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"random", " ", "symplectic", " ", "matrix", " ", "valued", " ", 
    RowBox[{"in", " ", "[", 
     RowBox[{"a", ",", "b"}], "]"}], " ", "for", " ", "c", " ", "modes"}], 
   " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"sympQ", "[", "mS_", "]"}], ":=", 
    RowBox[{"1", "-", 
     RowBox[{"Norm", "[", 
      RowBox[{
       RowBox[{"mS", ".", "mJ", ".", 
        RowBox[{"mS", "\[Transpose]"}]}], "-", "mJ"}], "]"}]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "check", " ", "if", " ", "the", " ", "input", " ", "is", " ", "a", " ", 
    "symplectic", " ", "matrix", " ", 
    RowBox[{"(", "1", ")"}], " ", "or", " ", "not", " ", 
    RowBox[{"(", "0", ")"}]}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.7663102882905464`*^9, 3.7663103579963512`*^9}, {
  3.766310412900603*^9, 3.7663104131529293`*^9}, {3.770518481003937*^9, 
  3.7705184811598*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"0fbf5ede-d622-44c9-98d0-212eaac567bf"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"mJ", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{"mS", "=", 
    RowBox[{"randomSymplecticMat", "[", 
     RowBox[{
      RowBox[{"-", "3"}], ",", "3"}], "]"}]}], ")"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"sympQ", "[", "mS", "]"}]}], "Input",
 CellChangeTimes->{{3.766310375607278*^9, 3.7663104365214825`*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"1cb60cf8-e8d0-4114-95d0-07f6dc7572de"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "1", "0"},
     {"0", "0", "0", "1"},
     {
      RowBox[{"-", "1"}], "0", "0", "0"},
     {"0", 
      RowBox[{"-", "1"}], "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7663103944289713`*^9, 3.7663104370470653`*^9}, 
   3.770518486007431*^9, 3.77052044682123*^9},
 CellLabel->
  "Out[7]//MatrixForm=",ExpressionUUID->"391d8f7a-b633-48f7-8bb5-\
2d70908acff6"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1.1668137452330416`", "0.2152394480791301`", "0.09193605692044779`", 
      "0.07958345090058848`"},
     {
      RowBox[{"-", "0.20737002528426088`"}], "1.2828384357693665`", 
      "0.08675299140290035`", 
      RowBox[{"-", "0.08454145256861847`"}]},
     {
      RowBox[{"-", "0.21791501944729733`"}], 
      RowBox[{"-", "0.04649093985631085`"}], "0.8145577085556002`", 
      "0.11999990030264336`"},
     {
      RowBox[{"-", "0.05377814230159203`"}], "0.2972768543818981`", 
      RowBox[{"-", "0.1198977865254745`"}], "0.7369120965014591`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7663103944289713`*^9, 3.7663104370470653`*^9}, 
   3.770518486007431*^9, 3.770520446826076*^9},
 CellLabel->
  "Out[8]//MatrixForm=",ExpressionUUID->"4f0b7dbd-c66d-4dd0-8054-\
4afbcff47904"],

Cell[BoxData["0.9999999999999998`"], "Output",
 CellChangeTimes->{{3.7663103944289713`*^9, 3.7663104370470653`*^9}, 
   3.770518486007431*^9, 3.7705204468304234`*^9},
 CellLabel->"Out[9]=",ExpressionUUID->"10b13847-26ae-4196-b761-277b34c25af2"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Identify the first column and row vectors of mS", "Subsubsection",
 CellChangeTimes->{{3.7663137786346674`*^9, 
  3.7663137910677137`*^9}},ExpressionUUID->"e569d764-aeaf-450e-9e25-\
0fc8a5dbea53"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mS", "\[LeftDoubleBracket]", 
   RowBox[{";;", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
  RowBox[{"(*", 
   RowBox[{"First", " ", "column", " ", "vector"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mS", "\[LeftDoubleBracket]", 
   RowBox[{"1", ",", ";;"}], "\[RightDoubleBracket]"}], " ", 
  RowBox[{"(*", 
   RowBox[{"First", " ", "row", " ", "vector"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.766310420742642*^9, 3.766310421925482*^9}, {
  3.766310993654772*^9, 3.766311033149602*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"ff2884cf-0511-486c-9bfb-0f023b2619d8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.1668137452330416`", ",", 
   RowBox[{"-", "0.20737002528426088`"}], ",", 
   RowBox[{"-", "0.21791501944729733`"}], ",", 
   RowBox[{"-", "0.05377814230159203`"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7663110070102515`*^9, 3.7663110337849035`*^9}, 
   3.770520454290126*^9},
 CellLabel->"Out[10]=",ExpressionUUID->"8ed12240-62ab-482b-871e-b984b2f4f7e0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1.1668137452330416`", ",", "0.2152394480791301`", ",", 
   "0.09193605692044779`", ",", "0.07958345090058848`"}], "}"}]], "Output",
 CellChangeTimes->{{3.7663110070102515`*^9, 3.7663110337849035`*^9}, 
   3.770520454292552*^9},
 CellLabel->"Out[11]=",ExpressionUUID->"3d9a8a16-dd05-4ecf-bdbd-0b6989b02557"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Construct local symplectic matrix mSL1 to decouple the (n+1)th quadrature; \
Obtain mS1=mS.mJ.mSL1.mS\
\>", "Subsubsection",
 CellChangeTimes->{{3.7663137991680984`*^9, 3.766313886918067*^9}, 
   3.7663139499782133`*^9},ExpressionUUID->"0f7eb2d4-3080-435c-97c3-\
17ad55f05603"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"cv", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"mS", "\[LeftDoubleBracket]", 
         RowBox[{"i", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"mS", "\[LeftDoubleBracket]", 
         RowBox[{
          RowBox[{"n", "+", "i"}], ",", "3"}], "\[RightDoubleBracket]"}]}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "List", " ", "of", " ", "2", "d", " ", "column", " ", "vectors", " ", 
    "for", " ", "all", " ", "modes"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rv", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"mS", "\[LeftDoubleBracket]", 
         RowBox[{"3", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"mS", "\[LeftDoubleBracket]", 
         RowBox[{"3", ",", 
          RowBox[{"n", "+", "i"}]}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "List", " ", "of", " ", "2", "d", " ", "row", " ", "vectors", " ", "for", 
    " ", "all", " ", "modes"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ncv", "=", 
    RowBox[{"Norm", "/@", "cv"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"list", " ", "of", " ", "norms", " ", "of", " ", "cv"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nrv", "=", 
    RowBox[{"Norm", "/@", "rv"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"list", " ", "of", " ", "norms", " ", "of", " ", "rv"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mL", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", GridBox[{
            {
             RowBox[{"rv", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], 
             RowBox[{"-", 
              RowBox[{"rv", "\[LeftDoubleBracket]", 
               RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}]},
            {
             RowBox[{"rv", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], 
             RowBox[{"rv", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}]}
           }], ")"}], "/", 
         RowBox[{
         "nrv", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
        ")"}], ".", 
       RowBox[{"(", GridBox[{
          {
           RowBox[{
            RowBox[{
            "nrv", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
            "/", 
            RowBox[{
            "ncv", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
           "0"},
          {"0", 
           RowBox[{
            RowBox[{
            "ncv", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
            "/", 
            RowBox[{
            "nrv", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}]}
         }], ")"}], ".", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", GridBox[{
            {
             RowBox[{"cv", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], 
             RowBox[{"cv", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]},
            {
             RowBox[{"-", 
              RowBox[{"cv", "\[LeftDoubleBracket]", 
               RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], 
             RowBox[{"cv", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}]}
           }], ")"}], "/", 
         RowBox[{
         "ncv", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
        ")"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "List", " ", "of", " ", "local", " ", "symplectic", " ", "operations", " ",
     "for", " ", "all", " ", "modes"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{"mSL1", "=", 
    RowBox[{"ArrayFlatten", "[", 
     RowBox[{"(", GridBox[{
        {
         RowBox[{"DiagonalMatrix", "[", 
          RowBox[{"mL", "\[LeftDoubleBracket]", 
           RowBox[{";;", ",", "1", ",", "1"}], "\[RightDoubleBracket]"}], 
          "]"}], 
         RowBox[{"DiagonalMatrix", "[", 
          RowBox[{"mL", "\[LeftDoubleBracket]", 
           RowBox[{";;", ",", "1", ",", "2"}], "\[RightDoubleBracket]"}], 
          "]"}]},
        {
         RowBox[{"DiagonalMatrix", "[", 
          RowBox[{"mL", "\[LeftDoubleBracket]", 
           RowBox[{";;", ",", "2", ",", "1"}], "\[RightDoubleBracket]"}], 
          "]"}], 
         RowBox[{"DiagonalMatrix", "[", 
          RowBox[{"mL", "\[LeftDoubleBracket]", 
           RowBox[{";;", ",", "2", ",", "2"}], "\[RightDoubleBracket]"}], 
          "]"}]}
       }], ")"}], "]"}]}], ")"}], "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"sympQ", "[", "mSL1", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"mS1", "=", 
     RowBox[{"mS", ".", "mJ", ".", "mSL1", ".", "mS"}]}], ")"}], "//", 
   "MatrixForm"}], "//", 
  "Chop"}], "\[IndentingNewLine]", "m", "\[IndentingNewLine]", 
 RowBox[{"sympQ", "[", "mS1", "]"}]}], "Input",
 CellChangeTimes->{{3.766311066188385*^9, 3.7663110952176723`*^9}, {
  3.766311186825035*^9, 3.766311323191505*^9}, {3.7663113570774593`*^9, 
  3.7663114056321487`*^9}, {3.7663115222157187`*^9, 3.766311846534089*^9}, {
  3.7663118825630937`*^9, 3.766312010449373*^9}, {3.766312045970455*^9, 
  3.7663121326856747`*^9}, {3.7663124930992155`*^9, 3.766312612693013*^9}, {
  3.766312647181336*^9, 3.766312831709095*^9}, {3.7663128950123496`*^9, 
  3.7663129209608994`*^9}, {3.7663130445922394`*^9, 3.766313087534672*^9}, {
  3.766313145961999*^9, 3.7663131762443275`*^9}, {3.766313445670518*^9, 
  3.766313445802165*^9}, {3.7663134910438743`*^9, 3.766313491356038*^9}, {
  3.770518494732649*^9, 3.770518504033997*^9}, {3.7705205745974216`*^9, 
  3.770520580922557*^9}, {3.770520620061315*^9, 
  3.7705206257778997`*^9}},ExpressionUUID->"fc51cfe6-b92c-45d9-85b9-\
a1514bdd178d"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.9033954091310645`", "0.`", 
      RowBox[{"-", "0.3694884083001695`"}], "0.`"},
     {"0.`", 
      RowBox[{"-", "1.0529037785045836`"}], "0.`", 
      RowBox[{"-", "0.37408207347388384`"}]},
     {"0.36110413304110195`", "0.`", "0.9592435382038867`", "0.`"},
     {"0.`", "0.1387487958576174`", "0.`", 
      RowBox[{"-", "0.900458885331515`"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7663113171516013`*^9, {3.7663113668158445`*^9, 3.7663113756801724`*^9}, {
   3.766311549997472*^9, 3.7663115535196047`*^9}, 3.7663116039200344`*^9, 
   3.766311645244323*^9, {3.766311680456603*^9, 3.766311709749957*^9}, {
   3.7663120879750853`*^9, 3.766312135087302*^9}, 3.766312836446843*^9, {
   3.766312903300372*^9, 3.7663129217408133`*^9}, {3.76631305836994*^9, 
   3.7663130881799097`*^9}, {3.7663131653513308`*^9, 3.7663131767480536`*^9}, 
   3.7663134939550915`*^9, 3.770518506167097*^9, 3.770520139177218*^9, 
   3.770520458353759*^9, 3.7705205824764013`*^9, 3.770520622206388*^9},
 CellLabel->
  "Out[45]//MatrixForm=",ExpressionUUID->"5b2312a9-9c94-43e8-8676-\
641d42f41c5d"],

Cell[BoxData["0.9999999999999996`"], "Output",
 CellChangeTimes->{
  3.7663113171516013`*^9, {3.7663113668158445`*^9, 3.7663113756801724`*^9}, {
   3.766311549997472*^9, 3.7663115535196047`*^9}, 3.7663116039200344`*^9, 
   3.766311645244323*^9, {3.766311680456603*^9, 3.766311709749957*^9}, {
   3.7663120879750853`*^9, 3.766312135087302*^9}, 3.766312836446843*^9, {
   3.766312903300372*^9, 3.7663129217408133`*^9}, {3.76631305836994*^9, 
   3.7663130881799097`*^9}, {3.7663131653513308`*^9, 3.7663131767480536`*^9}, 
   3.7663134939550915`*^9, 3.770518506167097*^9, 3.770520139177218*^9, 
   3.770520458353759*^9, 3.7705205824764013`*^9, 3.770520622210722*^9},
 CellLabel->"Out[46]=",ExpressionUUID->"e14df8d0-c404-4e1e-a7a0-f3ce1bb913ce"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.12866455638117633`", "0.11623640270822444`", "0.9999999999999997`", 
      "0.03481477768099506`"},
     {
      RowBox[{"-", "0.09708638202724167`"}], 
      RowBox[{"-", "0.263882847905451`"}], "0", 
      RowBox[{"-", "0.9142867658909258`"}]},
     {
      RowBox[{"-", "0.9999999999999997`"}], "0", "0", "0"},
     {
      RowBox[{"-", "0.04526052763684486`"}], "1.0742281625907817`", "0", 
      RowBox[{"-", "0.06763382894184015`"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7663113171516013`*^9, {3.7663113668158445`*^9, 3.7663113756801724`*^9}, {
   3.766311549997472*^9, 3.7663115535196047`*^9}, 3.7663116039200344`*^9, 
   3.766311645244323*^9, {3.766311680456603*^9, 3.766311709749957*^9}, {
   3.7663120879750853`*^9, 3.766312135087302*^9}, 3.766312836446843*^9, {
   3.766312903300372*^9, 3.7663129217408133`*^9}, {3.76631305836994*^9, 
   3.7663130881799097`*^9}, {3.7663131653513308`*^9, 3.7663131767480536`*^9}, 
   3.7663134939550915`*^9, 3.770518506167097*^9, 3.770520139177218*^9, 
   3.770520458353759*^9, 3.7705205824764013`*^9, 3.77052062221417*^9},
 CellLabel->
  "Out[47]//MatrixForm=",ExpressionUUID->"a0f1be14-68ef-41b9-a5e3-\
9f8a121e0e61"],

Cell[BoxData["0.9999999999999993`"], "Output",
 CellChangeTimes->{
  3.7663113171516013`*^9, {3.7663113668158445`*^9, 3.7663113756801724`*^9}, {
   3.766311549997472*^9, 3.7663115535196047`*^9}, 3.7663116039200344`*^9, 
   3.766311645244323*^9, {3.766311680456603*^9, 3.766311709749957*^9}, {
   3.7663120879750853`*^9, 3.766312135087302*^9}, 3.766312836446843*^9, {
   3.766312903300372*^9, 3.7663129217408133`*^9}, {3.76631305836994*^9, 
   3.7663130881799097`*^9}, {3.7663131653513308`*^9, 3.7663131767480536`*^9}, 
   3.7663134939550915`*^9, 3.770518506167097*^9, 3.770520139177218*^9, 
   3.770520458353759*^9, 3.7705205824764013`*^9, 3.7705206222166967`*^9},
 CellLabel->"Out[48]=",ExpressionUUID->"8b79ae4b-bcb0-4b54-9e42-72fc49b57131"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Identify the (n+1)th column and row vectors of mS", "Subsubsection",
 CellChangeTimes->{{3.7663137786346674`*^9, 3.7663137910677137`*^9}, {
  3.766313909642662*^9, 
  3.76631393691254*^9}},ExpressionUUID->"39badbb1-8270-4a3e-9444-\
ccc54c577586"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mS", "\[LeftDoubleBracket]", 
   RowBox[{";;", ",", 
    RowBox[{"n", "+", "1"}]}], "\[RightDoubleBracket]"}], " ", 
  RowBox[{"(*", 
   RowBox[{"First", " ", "column", " ", "vector"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mS", "\[LeftDoubleBracket]", 
   RowBox[{
    RowBox[{"n", "+", "1"}], ",", ";;"}], "\[RightDoubleBracket]"}], " ", 
  RowBox[{"(*", 
   RowBox[{"First", " ", "row", " ", "vector"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.766310420742642*^9, 3.766310421925482*^9}, {
  3.766310993654772*^9, 3.766311033149602*^9}, {3.7663139141733313`*^9, 
  3.7663139170985384`*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"1f0f3efe-540a-4699-93b6-1be15a73d050"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.09193605692044779`", ",", "0.08675299140290035`", ",", 
   "0.8145577085556002`", ",", 
   RowBox[{"-", "0.1198977865254745`"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7663110070102515`*^9, 3.7663110337849035`*^9}, 
   3.766313918013094*^9, 3.770520463427434*^9},
 CellLabel->"Out[21]=",ExpressionUUID->"a8f5d0a7-63cb-472a-b6de-21fee9c0ec1e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.21791501944729733`"}], ",", 
   RowBox[{"-", "0.04649093985631085`"}], ",", "0.8145577085556002`", ",", 
   "0.11999990030264336`"}], "}"}]], "Output",
 CellChangeTimes->{{3.7663110070102515`*^9, 3.7663110337849035`*^9}, 
   3.766313918013094*^9, 3.770520463430739*^9},
 CellLabel->"Out[22]=",ExpressionUUID->"7d83c1be-de81-4123-9150-438e56f0d850"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Construct local symplectic matrix mSL2 to decouple the fisrt mode ; Obtain \
mS2=mS1.mJ.mSL2.mS1\
\>", "Subsubsection",
 CellChangeTimes->{{3.7663138585224047`*^9, 3.7663138607424707`*^9}, {
  3.766313944862883*^9, 
  3.766314007833115*^9}},ExpressionUUID->"dd419199-1d13-4e74-848e-\
7259282fe271"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"cv", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"mS1", "\[LeftDoubleBracket]", 
          RowBox[{
           RowBox[{"i", "+", "1"}], ",", 
           RowBox[{"n", "+", "1"}]}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"mS1", "\[LeftDoubleBracket]", 
          RowBox[{
           RowBox[{"n", "+", "i", "+", "1"}], ",", 
           RowBox[{"n", "+", "1"}]}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], ";", "  ", 
    RowBox[{"(*", " ", 
     RowBox[{
     "List", " ", "of", " ", "2", "d", " ", "column", " ", "vectors", " ", 
      "for", " ", "all", " ", "modes"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"rv", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"mS1", "\[LeftDoubleBracket]", 
          RowBox[{
           RowBox[{"n", "+", "1"}], ",", 
           RowBox[{"i", "+", "1"}]}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"mS1", "\[LeftDoubleBracket]", 
          RowBox[{
           RowBox[{"n", "+", "1"}], ",", 
           RowBox[{"n", "+", "i", "+", "1"}]}], "\[RightDoubleBracket]"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "List", " ", "of", " ", "2", "d", " ", "row", " ", "vectors", " ", "for", 
     " ", "all", " ", "modes"}], " ", "*)"}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"cv", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"mS1", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "4"}], "]"}], "]"}], ",", 
         RowBox[{"mS1", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "4"}], "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"mS1", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "4"}], "]"}], "]"}], ",", 
         RowBox[{"mS1", "[", 
          RowBox[{"[", 
           RowBox[{"4", ",", "4"}], "]"}], "]"}]}], "}"}]}], "}"}]}], ";", 
    RowBox[{"rv", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"mS1", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"mS1", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"mS1", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "3"}], "]"}], "]"}], ",", 
         RowBox[{"mS1", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "4"}], "]"}], "]"}]}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ncv", "=", 
     RowBox[{"Norm", "/@", "cv"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"list", " ", "of", " ", "norms", " ", "of", " ", "cv"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nrv", "=", 
     RowBox[{"Norm", "/@", "rv"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"list", " ", "of", " ", "norms", " ", "of", " ", "rv"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mL", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", GridBox[{
             {
              RowBox[{"rv", "\[LeftDoubleBracket]", 
               RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], 
              RowBox[{"-", 
               RowBox[{"rv", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}]},
             {
              RowBox[{"rv", "\[LeftDoubleBracket]", 
               RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], 
              RowBox[{"rv", "\[LeftDoubleBracket]", 
               RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}]}
            }], ")"}], "/", 
          RowBox[{
          "nrv", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
         ")"}], ".", 
        RowBox[{"(", GridBox[{
           {
            RowBox[{
             RowBox[{
             "nrv", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
             "/", 
             RowBox[{
             "ncv", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
            "0"},
           {"0", 
            RowBox[{
             RowBox[{
             "ncv", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
             "/", 
             RowBox[{
             "nrv", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}]}
          }], ")"}], ".", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", GridBox[{
             {
              RowBox[{"cv", "\[LeftDoubleBracket]", 
               RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], 
              RowBox[{"cv", "\[LeftDoubleBracket]", 
               RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]},
             {
              RowBox[{"-", 
               RowBox[{"cv", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], 
              RowBox[{"cv", "\[LeftDoubleBracket]", 
               RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}]}
            }], ")"}], "/", 
          RowBox[{
          "ncv", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
         ")"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
    "List", " ", "of", " ", "local", " ", "symplectic", " ", "operations", 
     " ", "for", " ", "all", " ", "modes"}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"mSL2", "=", 
      RowBox[{"ArrayFlatten", "[", 
       RowBox[{"(", GridBox[{
          {
           RowBox[{"DiagonalMatrix", "[", 
            RowBox[{"mL", "\[LeftDoubleBracket]", 
             RowBox[{";;", ",", "1", ",", "1"}], "\[RightDoubleBracket]"}], 
            "]"}], 
           RowBox[{"DiagonalMatrix", "[", 
            RowBox[{"mL", "\[LeftDoubleBracket]", 
             RowBox[{";;", ",", "1", ",", "2"}], "\[RightDoubleBracket]"}], 
            "]"}]},
          {
           RowBox[{"DiagonalMatrix", "[", 
            RowBox[{"mL", "\[LeftDoubleBracket]", 
             RowBox[{";;", ",", "2", ",", "1"}], "\[RightDoubleBracket]"}], 
            "]"}], 
           RowBox[{"DiagonalMatrix", "[", 
            RowBox[{"mL", "\[LeftDoubleBracket]", 
             RowBox[{";;", ",", "2", ",", "2"}], "\[RightDoubleBracket]"}], 
            "]"}]}
         }], ")"}], "]"}]}], ")"}], "//", "MatrixForm"}], 
   "\[IndentingNewLine]", 
   RowBox[{"sympQ", "[", "mSL2", "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"mS2", "=", 
       RowBox[{"mS1", ".", "mJ", ".", "mSL2", ".", "mS1"}]}], ")"}], "//", 
     "MatrixForm"}], "//", "Chop"}], "\[IndentingNewLine]", 
   RowBox[{"sympQ", "[", "mS2", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.76631324146776*^9, 3.766313403333029*^9}, {
   3.7663135907458415`*^9, 3.766313659852239*^9}, {3.766313708841173*^9, 
   3.7663137192054524`*^9}, 3.7705187671663647`*^9, {3.770520123780673*^9, 
   3.770520129882407*^9}, {3.770520174847189*^9, 3.7705201957919207`*^9}, {
   3.770520242065199*^9, 3.770520242593246*^9}, {3.770520316356373*^9, 
   3.770520357938716*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"961b2b8e-0085-4684-9f46-c0b8e02c8cdb"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"3.0476298330770963`", "0.`", "0.2222376443585417`", "0.`"},
     {"0.`", "0.07397441532026819`", "0.`", 
      RowBox[{"-", "3.8002244645482543`*^-16"}]},
     {
      RowBox[{"-", "1.1337277574731615`"}], "0.`", "0.24545074526980756`", 
      "0.`"},
     {"0.`", 
      RowBox[{"-", "5.5453489853493`*^-15"}], "0.`", "13.518187276919388`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.766313661629489*^9, 3.7663137196918783`*^9, 
  3.7705187686042747`*^9, 3.77052014348694*^9, 3.770520254788518*^9, 
  3.770520466545497*^9},
 CellLabel->
  "Out[27]//MatrixForm=",ExpressionUUID->"638b6752-1880-472e-83e3-\
0f7c47c15817"],

Cell[BoxData["1.`"], "Output",
 CellChangeTimes->{3.766313661629489*^9, 3.7663137196918783`*^9, 
  3.7705187686042747`*^9, 3.77052014348694*^9, 3.770520254788518*^9, 
  3.77052046655363*^9},
 CellLabel->"Out[28]=",ExpressionUUID->"92d1531a-3787-461d-8f21-3f6375a660fd"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "0.2911015583796183`"}], "1.3174191820727947`", 
      RowBox[{"-", "3.1935004120494046`"}], 
      RowBox[{"-", "0.21509975486223873`"}]},
     {"0.19287980571041813`", 
      RowBox[{"-", "3.837059098452697`"}], "0.11006952617692721`", 
      "0.18325992694080767`"},
     {"0.3913213242421175`", "0.13178043617914312`", "1.1337277574731606`", 
      "0.039470479827201144`"},
     {
      RowBox[{"-", "0.640030399636988`"}], "15.604174663979567`", 
      "0.05131311649977217`", 
      RowBox[{"-", "0.9849404726783476`"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.766313661629489*^9, 3.7663137196918783`*^9, 
  3.7705187686042747`*^9, 3.77052014348694*^9, 3.770520254788518*^9, 
  3.770520466557852*^9},
 CellLabel->
  "Out[29]//MatrixForm=",ExpressionUUID->"af9b493a-a6d0-4b4b-a625-\
8d177db5e923"],

Cell[BoxData["0.9999999999999948`"], "Output",
 CellChangeTimes->{3.766313661629489*^9, 3.7663137196918783`*^9, 
  3.7705187686042747`*^9, 3.77052014348694*^9, 3.770520254788518*^9, 
  3.7705204665611887`*^9},
 CellLabel->"Out[30]=",ExpressionUUID->"bf2c2b07-f55d-4286-9075-d27a1bf5bbbc"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Symplectic matrices in {q1,p1,q2,p2,...} basis", "Subsubsection",
 CellChangeTimes->{{3.7663140255315156`*^9, 
  3.766314038928166*^9}},ExpressionUUID->"9fc41546-d994-4a4b-9eaa-\
6020f9c565c4"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"mS", "\[LeftDoubleBracket]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "1", ",", "5", ",", "2", ",", "6", ",", "3", ",", "7", ",", "4", ",", 
       "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1", ",", "5", ",", "2", ",", "6", ",", "3", ",", "7", ",", "4", ",", 
       "8"}], "}"}]}], "\[RightDoubleBracket]"}], "//", "MatrixForm"}], "//", 
  "Chop"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mSL1", "\[LeftDoubleBracket]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "1", ",", "5", ",", "2", ",", "6", ",", "3", ",", "7", ",", "4", ",", 
       "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1", ",", "5", ",", "2", ",", "6", ",", "3", ",", "7", ",", "4", ",", 
       "8"}], "}"}]}], "\[RightDoubleBracket]"}], "//", "MatrixForm"}], "//", 
  "Chop"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mS1", "\[LeftDoubleBracket]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "1", ",", "5", ",", "2", ",", "6", ",", "3", ",", "7", ",", "4", ",", 
       "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1", ",", "5", ",", "2", ",", "6", ",", "3", ",", "7", ",", "4", ",", 
       "8"}], "}"}]}], "\[RightDoubleBracket]"}], "//", "MatrixForm"}], "//", 
  "Chop"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mSL2", "\[LeftDoubleBracket]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "1", ",", "5", ",", "2", ",", "6", ",", "3", ",", "7", ",", "4", ",", 
       "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1", ",", "5", ",", "2", ",", "6", ",", "3", ",", "7", ",", "4", ",", 
       "8"}], "}"}]}], "\[RightDoubleBracket]"}], "//", "MatrixForm"}], "//", 
  "Chop"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mS2", "\[LeftDoubleBracket]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "1", ",", "5", ",", "2", ",", "6", ",", "3", ",", "7", ",", "4", ",", 
       "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1", ",", "5", ",", "2", ",", "6", ",", "3", ",", "7", ",", "4", ",", 
       "8"}], "}"}]}], "\[RightDoubleBracket]"}], "//", "MatrixForm"}], "//", 
  "Chop"}]}], "Input",
 CellChangeTimes->{{3.7663140453357224`*^9, 3.766314167539554*^9}},
 CellLabel->
  "In[216]:=",ExpressionUUID->"81f491cb-f031-4cca-8ebd-8b694ee4fe46"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.92798832495143`", "0.26322751797701305`", "0.16060818429647028`", 
      "0.1390834164938116`", "0.06493565073597794`", 
      RowBox[{"-", "0.4274755424041812`"}], 
      RowBox[{"-", "0.05063636255699829`"}], 
      RowBox[{"-", "0.09394518111576733`"}]},
     {
      RowBox[{"-", "0.038680831174756236`"}], "1.1046064054218983`", 
      RowBox[{"-", "0.03939407220595437`"}], 
      RowBox[{"-", "0.1380738099467985`"}], "0.02860799702205658`", 
      RowBox[{"-", "0.11868737836655446`"}], 
      RowBox[{"-", "0.28680735642765715`"}], 
      RowBox[{"-", "0.07652616883339686`"}]},
     {"0.14901244219898985`", "0.3144884103633704`", "1.2218310966520831`", 
      RowBox[{"-", "0.160617594271016`"}], 
      RowBox[{"-", "0.10387213093266526`"}], 
      RowBox[{"-", "0.23716421322834927`"}], 
      RowBox[{"-", "0.009472714913120739`"}], 
      RowBox[{"-", "0.07521609758107546`"}]},
     {
      RowBox[{"-", "0.06592354632975701`"}], 
      RowBox[{"-", "0.40086976722034`"}], 
      RowBox[{"-", "0.4621444595946885`"}], "0.9191880728786208`", 
      "0.23961052956876241`", "0.6621631246574998`", "0.04499020733804402`", 
      "0.13643225441932297`"},
     {"0.09454243768430769`", 
      RowBox[{"-", "0.7652969126328191`"}], 
      RowBox[{"-", "0.6527297879725714`"}], "0.01441826348393888`", 
      "1.349142314269411`", "0.9265143667435763`", "0.10954142043096862`", 
      "0.10282834370819316`"},
     {"0.03948841360208475`", 
      RowBox[{"-", "0.15585140734590164`"}], "0.07298636754462787`", 
      "0.052207210086484365`", "0.24267638438363898`", "0.9140087117361383`", 
      RowBox[{"-", "0.02262642455540003`"}], "0.08245683679358755`"},
     {"0.04391790100905925`", 
      RowBox[{"-", "0.06497093143416827`"}], 
      RowBox[{"-", "0.07423666180803973`"}], 
      RowBox[{"-", "0.03308407871817606`"}], 
      RowBox[{"-", "0.1305950067033806`"}], 
      RowBox[{"-", "0.030646775476147137`"}], "1.3932516945936169`", 
      "0.12307147810886045`"},
     {
      RowBox[{"-", "0.1916684521184266`"}], "0.016525686372708667`", 
      "0.004915303190527252`", 
      RowBox[{"-", "0.03771184554829802`"}], 
      RowBox[{"-", "0.05814867099680402`"}], 
      RowBox[{"-", "0.0071095552236333575`"}], "0.03313654930901998`", 
      "0.7275761080996932`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.766314072976462*^9, 3.7663141680771184`*^9}},
 CellLabel->
  "Out[216]//MatrixForm=",ExpressionUUID->"2fa59aa2-c528-4f43-b669-\
a97c71b8a4ef"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.9873226581269728`", 
      RowBox[{"-", "0.3041409631669163`"}], "0", "0", "0", "0", "0", "0"},
     {"0.3217403882011266`", "0.9137292262230181`", "0", "0", "0", "0", "0", 
      "0"},
     {"0", "0", "0.6982713061733579`", 
      RowBox[{"-", "0.857919132007777`"}], "0", "0", "0", "0"},
     {"0", "0", "1.0151506658650842`", "0.18486055597974504`", "0", "0", "0", 
      "0"},
     {"0", "0", "0", "0", "0.4945242329243091`", "0.4604420031801808`", "0", 
      "0"},
     {"0", "0", "0", "0", 
      RowBox[{"-", "3.8636007410396367`"}], 
      RowBox[{"-", "1.575178753296702`"}], "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1.5234106861319763`", 
      "0.6132535686888103`"},
     {"0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "0.9588239921738332`"}], "0.27044431866303237`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.766314072976462*^9, 3.7663141680860925`*^9}},
 CellLabel->
  "Out[217]//MatrixForm=",ExpressionUUID->"927dc73f-70e8-46f0-94c0-\
25e9de53ebcf"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1.0000000000000004`", "0", "0", "0", "0", "0", "0"},
     {
      RowBox[{"-", "1.0000000000000002`"}], "0.12208299918733222`", 
      RowBox[{"-", "0.05663874427945486`"}], 
      RowBox[{"-", "0.33160877863077487`"}], 
      RowBox[{"-", "0.21598097607727487`"}], "0.2881584086715727`", 
      "0.502102305458674`", "0.08058542720267996`"},
     {"0", "0.13026137650394057`", "1.2329579658896792`", 
      RowBox[{"-", "0.18881835389692414`"}], "0.6173914059291344`", 
      "0.5480303302594796`", "0.162341407835122`", "0.03995253370672036`"},
     {"0", "0.3466662708376579`", 
      RowBox[{"-", "0.8285731933355914`"}], "0.8593351156418305`", 
      RowBox[{"-", "1.5164166016120577`"}], 
      RowBox[{"-", "1.1859772546387224`"}], 
      RowBox[{"-", "0.3984521844924289`"}], 
      RowBox[{"-", "0.10979053755138621`"}]},
     {"0", "4.6310118877063156`", "2.894618444501479`", 
      RowBox[{"-", "0.06702923421311927`"}], 
      RowBox[{"-", "8.142975577933136`"}], 
      RowBox[{"-", "7.808874975838909`"}], 
      RowBox[{"-", "0.925458393092635`"}], 
      RowBox[{"-", "0.8768715655110149`"}]},
     {"0", "1.2142586633955428`", "0.9021082473385447`", 
      "0.01587047301322703`", 
      RowBox[{"-", "2.032252287797883`"}], 
      RowBox[{"-", "2.0581466853983836`"}], 
      RowBox[{"-", "0.2836371410634714`"}], 
      RowBox[{"-", "0.2728081528845381`"}]},
     {"0", 
      RowBox[{"-", "0.2844985873080136`"}], 
      RowBox[{"-", "0.2412468040918745`"}], "0.035770044516466176`", 
      "0.9369531321746312`", "0.6756266599044827`", 
      RowBox[{"-", "2.07170277744249`"}], "0.09259331479734678`"},
     {"0", 
      RowBox[{"-", "0.3085302879748308`"}], 
      RowBox[{"-", "0.01254213992115306`"}], "0.04115897657073632`", 
      "0.4844744306426208`", "0.3614477001857484`", 
      RowBox[{"-", "1.5291572246288714`"}], 
      RowBox[{"-", "0.4134547669114166`"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.766314072976462*^9, 3.766314168097063*^9}},
 CellLabel->
  "Out[218]//MatrixForm=",ExpressionUUID->"3b2118dd-0297-426a-9322-\
2b6c2ea856c8"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1.`", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "1.`", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1.069570316508847`", 
      RowBox[{"-", "0.23851457257998981`"}], "0", "0", "0", "0"},
     {"0", "0", "0.14146915828567777`", "0.9034072180800352`", "0", "0", "0", 
      "0"},
     {"0", "0", "0", "0", 
      RowBox[{"-", "2.6544698774671383`"}], "10.301645696483023`", "0", "0"},
     {"0", "0", "0", "0", 
      RowBox[{"-", "2.0805112366804774`"}], "7.697465245802912`", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0.9071766296744688`", 
      "0.7908845432295079`"},
     {"0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "0.46887869098542345`"}], "0.6935486101264704`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.766314072976462*^9, 3.7663141681050415`*^9}},
 CellLabel->
  "Out[219]//MatrixForm=",ExpressionUUID->"634acd01-c847-4b1d-a259-\
416da3f0de93"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", 
      RowBox[{"-", "1.0000000000000009`"}], "0", "0", "0", "0", "0", "0"},
     {"1.`", 
      RowBox[{"-", "0.24416599837466552`"}], "0", "0", "0", "0", "0", "0"},
     {"0", "0", 
      RowBox[{"-", "0.7084910937773462`"}], "0.8211400804232689`", 
      RowBox[{"-", "1.0253739155330834`"}], 
      RowBox[{"-", "0.598890666707574`"}], 
      RowBox[{"-", "0.16003220440549445`"}], 
      RowBox[{"-", "0.05178981258000929`"}]},
     {"0", "0", 
      RowBox[{"-", "0.3828553192929544`"}], 
      RowBox[{"-", "0.260794333210506`"}], 
      RowBox[{"-", "0.8016864784709121`"}], 
      RowBox[{"-", "0.9728045136929304`"}], 
      RowBox[{"-", "0.41608675076563834`"}], 
      RowBox[{"-", "0.03146192433116597`"}]},
     {"0", "0", "3.2060594581828066`", "2.7244373416210603`", 
      RowBox[{"-", "7.731724506494112`"}], 
      RowBox[{"-", "8.959092842727387`"}], 
      RowBox[{"-", "5.117357377075039`"}], 
      RowBox[{"-", "1.6992081726459516`"}]},
     {"0", "0", "0.8055800011023322`", "0.8681054552767581`", 
      RowBox[{"-", "2.0471405797709967`"}], 
      RowBox[{"-", "2.4426562060484067`"}], 
      RowBox[{"-", "1.5593035599169434`"}], 
      RowBox[{"-", "0.49160403805912806`"}]},
     {"0", "0", 
      RowBox[{"-", "0.33475840642530574`"}], 
      RowBox[{"-", "0.1822466843824244`"}], "1.1299658093213139`", 
      "0.9610525686010353`", "0.6152038912018214`", "0.7945446594807056`"},
     {"0", "0", 
      RowBox[{"-", "0.44470540033534994`"}], "0.019559461755118926`", 
      "1.025181090734287`", "0.8163651999811811`", 
      RowBox[{"-", "1.1042892089433827`"}], "0.4437144270938531`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.766314072976462*^9, 3.766314168115015*^9}},
 CellLabel->
  "Out[220]//MatrixForm=",ExpressionUUID->"719d2147-5f34-4030-8e2f-\
3fe642d58549"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1200, 712},
WindowMargins->{{0, Automatic}, {Automatic, 44}},
Magnification:>1.5 Inherited,
FrontEndVersion->"11.3 for Linux x86 (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 191, 3, 68, "Subsubsection",ExpressionUUID->"14a1d5cd-b107-4f14-bc25-2eb3bfb8829a"],
Cell[774, 27, 3481, 104, 455, "Input",ExpressionUUID->"0fbf5ede-d622-44c9-98d0-212eaac567bf"],
Cell[CellGroupData[{
Cell[4280, 135, 475, 11, 116, "Input",ExpressionUUID->"1cb60cf8-e8d0-4114-95d0-07f6dc7572de"],
Cell[4758, 148, 915, 26, 153, "Output",ExpressionUUID->"391d8f7a-b633-48f7-8bb5-2d70908acff6"],
Cell[5676, 176, 1322, 33, 153, "Output",ExpressionUUID->"4f0b7dbd-c66d-4dd0-8054-4afbcff47904"],
Cell[7001, 211, 244, 3, 53, "Output",ExpressionUUID->"10b13847-26ae-4196-b761-277b34c25af2"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[7294, 220, 202, 3, 68, "Subsubsection",ExpressionUUID->"e569d764-aeaf-450e-9e25-0fc8a5dbea53"],
Cell[CellGroupData[{
Cell[7521, 227, 628, 14, 82, "Input",ExpressionUUID->"ff2884cf-0511-486c-9bfb-0f023b2619d8"],
Cell[8152, 243, 400, 8, 74, "Output",ExpressionUUID->"8ed12240-62ab-482b-871e-b984b2f4f7e0"],
Cell[8555, 253, 349, 7, 74, "Output",ExpressionUUID->"3d9a8a16-dd05-4ecf-bdbd-0b6989b02557"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[8953, 266, 287, 6, 108, "Subsubsection",ExpressionUUID->"0f7eb2d4-3080-435c-97c3-17ad55f05603"],
Cell[CellGroupData[{
Cell[9265, 276, 6402, 163, 703, "Input",ExpressionUUID->"fc51cfe6-b92c-45d9-85b9-a1514bdd178d"],
Cell[15670, 441, 1620, 35, 153, "Output",ExpressionUUID->"5b2312a9-9c94-43e8-8676-641d42f41c5d"],
Cell[17293, 478, 741, 10, 74, "Output",ExpressionUUID->"e14df8d0-c404-4e1e-a7a0-f3ce1bb913ce"],
Cell[18037, 490, 1712, 38, 153, "Output",ExpressionUUID->"a0f1be14-68ef-41b9-a5e3-9f8a121e0e61"],
Cell[19752, 530, 743, 10, 74, "Output",ExpressionUUID->"8b79ae4b-bcb0-4b54-9e42-72fc49b57131"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[20544, 546, 252, 4, 68, "Subsubsection",ExpressionUUID->"39badbb1-8270-4a3e-9444-ccc54c577586"],
Cell[CellGroupData[{
Cell[20821, 554, 731, 17, 82, "Input",ExpressionUUID->"1f0f3efe-540a-4699-93b6-1be15a73d050"],
Cell[21555, 573, 390, 8, 74, "Output",ExpressionUUID->"a8f5d0a7-63cb-472a-b6de-21fee9c0ec1e"],
Cell[21948, 583, 407, 8, 74, "Output",ExpressionUUID->"7d83c1be-de81-4123-9150-438e56f0d850"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[22404, 597, 308, 7, 108, "Subsubsection",ExpressionUUID->"dd419199-1d13-4e74-848e-7259282fe271"],
Cell[CellGroupData[{
Cell[22737, 608, 7692, 203, 805, "Input",ExpressionUUID->"961b2b8e-0085-4684-9f46-c0b8e02c8cdb"],
Cell[30432, 813, 1158, 29, 161, "Output",ExpressionUUID->"638b6752-1880-472e-83e3-0f7c47c15817"],
Cell[31593, 844, 269, 4, 74, "Output",ExpressionUUID->"92d1531a-3787-461d-8f21-3f6375a660fd"],
Cell[31865, 850, 1363, 34, 153, "Output",ExpressionUUID->"af9b493a-a6d0-4b4b-a625-8d177db5e923"],
Cell[33231, 886, 288, 4, 74, "Output",ExpressionUUID->"bf2c2b07-f55d-4286-9075-d27a1bf5bbbc"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[33568, 896, 199, 3, 68, "Subsubsection",ExpressionUUID->"9fc41546-d994-4a4b-9eaa-6020f9c565c4"],
Cell[CellGroupData[{
Cell[33792, 903, 2358, 68, 184, "Input",ExpressionUUID->"81f491cb-f031-4cca-8ebd-8b694ee4fe46"],
Cell[36153, 973, 2909, 64, 265, "Output",ExpressionUUID->"2fa59aa2-c528-4f43-b669-a97c71b8a4ef"],
Cell[39065, 1039, 1415, 34, 596, "Output",ExpressionUUID->"927dc73f-70e8-46f0-94c0-25e9de53ebcf"],
Cell[40483, 1075, 2519, 56, 1248, "Output",ExpressionUUID->"3b2118dd-0297-426a-9322-2b6c2ea856c8"],
Cell[43005, 1133, 1312, 31, 1248, "Output",ExpressionUUID->"634acd01-c847-4b1d-a259-416da3f0de93"],
Cell[44320, 1166, 2241, 52, 1248, "Output",ExpressionUUID->"719d2147-5f34-4030-8e2f-3fe642d58549"]
}, Open  ]]
}, Open  ]]
}
]
*)

